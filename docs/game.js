!function(r){var n={};function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=r,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,r){"use strict";r.r(t);var a={};r.r(a),r.d(a,"GameScene",function(){return n}),r.d(a,"PreloadScene",function(){return o});var n="game",o="preload";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(a){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r,n,o=l(a);return t=i?(e=l(this).constructor,Reflect.construct(o,arguments,e)):o.apply(this,arguments),r=this,!(n=t)||"object"!==s(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(r):n}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(a){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r,n,o=m(a);return t=i?(e=m(this).constructor,Reflect.construct(o,arguments,e)):o.apply(this,arguments),r=this,!(n=t)||"object"!==p(n)&&"function"!=typeof n?d(r):n}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=[[1,0,3],[2,4,1],[3,4,2]],x=[function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(o,Phaser.Scene);var e,t,r,n=u(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),n.call(this,a.PreloadScene)}return e=o,(t=[{key:"preload",value:function(){this.load.spritesheet("sokoban","assets/textures/sokoban_tilesheet.png",{frameWidth:64}),this.load.image("bear","assets/textures/bear.png"),this.load.image("chicken","assets/textures/chicken.png"),this.load.image("duck","assets/textures/duck.png"),this.load.image("parrot","assets/textures/parrot.png"),this.load.image("penguin","assets/textures/penguin.png")}},{key:"create",value:function(){this.anims.create({key:"down-idle",frames:[{key:"sokoban",frame:52}]}),this.anims.create({key:"up-idle",frames:[{key:"sokoban",frame:55}]}),this.anims.create({key:"left-idle",frames:[{key:"sokoban",frame:81}]}),this.anims.create({key:"right-idle",frames:[{key:"sokoban",frame:78}]}),this.anims.create({key:"down-walk",frames:this.anims.generateFrameNumbers("sokoban",{start:52,end:54}),frameRate:10,repeat:-1}),this.anims.create({key:"up-walk",frames:this.anims.generateFrameNumbers("sokoban",{start:55,end:57}),frameRate:10,repeat:-1}),this.anims.create({key:"left-walk",frames:this.anims.generateFrameNumbers("sokoban",{start:81,end:83}),frameRate:10,repeat:-1}),this.anims.create({key:"right-walk",frames:this.anims.generateFrameNumbers("sokoban",{start:78,end:80}),frameRate:10,repeat:-1}),this.scene.start(a.GameScene)}}])&&i(e.prototype,t),r&&i(e,r),o}(),function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(o,Phaser.Scene);var e,t,r,n=y(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),b(d(e=n.call(this,a.GameScene)),"cursors",void 0),b(d(e),"player",void 0),b(d(e),"boxGroup",void 0),b(d(e),"activeBox",void 0),b(d(e),"itemsGroup",void 0),b(d(e),"selectedBoxes",[]),b(d(e),"matchesCount",void 0),e}return e=o,(t=[{key:"init",value:function(){this.cursors=this.input.keyboard.createCursorKeys(),this.matchesCount=0}},{key:"create",value:function(){var e=this.scale,t=e.width,r=e.height;this.player=this.physics.add.sprite(.5*t,.63*r,"sokoban").setSize(40,16).setOffset(12,38).play("down-idle"),this.boxGroup=this.physics.add.staticGroup(),this.createdBoxes(),this.physics.add.collider(this.boxGroup,this.player,this.handlePlayerBoxCollide,void 0,this),this.itemsGroup=this.add.group()}},{key:"update",value:function(){this.updatePlayer(),this.updateActiveBox(),this.children.each(function(e){var t=e;t.getData("sorted")||t.setDepth(t.y)})}},{key:"createdBoxes",value:function(){for(var e=this.scale.width,t=.25,r=150,n=0;n<v.length;++n){for(var o=0;o<v[n].length;++o){this.boxGroup.get(e*t,r,"sokoban",10).setSize(64,32).setOffset(0,32).setData("itemType",v[n][o]),t+=.25}t=.25,r+=150}}},{key:"handlePlayerBoxCollide",value:function(e,t){t.getData("opened")||this.activeBox||(this.activeBox=t,this.activeBox.setFrame(9))}},{key:"updatePlayer",value:function(){var e;this.player.active&&(this.cursors.left.isDown?(this.player.setVelocity(-200,0),this.player.play("left-walk",!0)):this.cursors.right.isDown?(this.player.setVelocity(200,0),this.player.play("right-walk",!0)):this.cursors.up.isDown?(this.player.setVelocity(0,-200),this.player.play("up-walk",!0)):this.cursors.down.isDown?(this.player.setVelocity(0,200),this.player.play("down-walk",!0)):(this.player.setVelocity(0,0),e=this.player.anims.currentAnim.key.split("-")[0],this.player.play("".concat(e,"-idle"),!0)),Phaser.Input.Keyboard.JustUp(this.cursors.space)&&this.activeBox&&(this.openBox(this.activeBox),this.activeBox.setFrame(10),this.activeBox=void 0))}},{key:"updateActiveBox",value:function(){this.activeBox&&(Phaser.Math.Distance.Between(this.player.x,this.player.y,this.activeBox.x,this.activeBox.y)<64||(this.activeBox.setFrame(10),this.activeBox=void 0))}},{key:"openBox",value:function(e){var t=this;if(e){var r,n=e.getData("itemType");switch(n){case 0:(r=this.itemsGroup.get(e.x,e.y)).setTexture("bear");break;case 1:(r=this.itemsGroup.get(e.x,e.y)).setTexture("chicken");break;case 2:(r=this.itemsGroup.get(e.x,e.y)).setTexture("duck");break;case 3:(r=this.itemsGroup.get(e.x,e.y)).setTexture("parrot");break;case 4:(r=this.itemsGroup.get(e.x,e.y)).setTexture("penguin")}e.setData("opened",!0),r.setData("sorted",!0),r.setDepth(2e3),r.setActive(!0),r.setVisible(!0),r.setScale(0),r.setAlpha(0),this.selectedBoxes.push({box:e,item:r}),this.tweens.add({targets:r,y:"-=50",alpha:1,scale:1,duration:500,onComplete:function(){0!==n?t.selectedBoxes.length<2||t.checkForMatch():t.handleBearSelected()}})}}},{key:"checkForMatch",value:function(){var n=this,o=this.selectedBoxes.pop(),a=this.selectedBoxes.pop();a.item.texture===o.item.texture?(++this.matchesCount,this.time.delayedCall(1e3,function(){var e,t,r;a.box.setFrame(8),o.box.setFrame(8),4<=n.matchesCount&&(n.player.active=!1,n.player.setVelocity(0,0),t=(e=n.scale).width,r=e.height,n.add.text(.5*t,.5*r,"You Win!",{fontSize:48}).setOrigin(.5))})):this.tweens.add({targets:[a.item,o.item],y:"+=50",alpha:0,scale:0,duration:300,delay:1e3,onComplete:function(){n.itemsGroup.killAndHide(a.item),n.itemsGroup.killAndHide(o.item),a.box.setData("opened",!1),o.box.setData("opened",!1)}})}},{key:"handleBearSelected",value:function(){var e=this,t=this.selectedBoxes.pop(),r=t.box,n=t.item;n.setTint(16711680),r.setFrame(7),this.player.active=!1,this.player.setVelocity(0,0),this.time.delayedCall(1e3,function(){n.setTint(16777215),r.setFrame(10),r.setData("opened",!1),e.tweens.add({targets:n,y:"+=50",alpha:0,scale:0,duration:300,onComplete:function(){e.player.active=!0}})})}}])&&f(e.prototype,t),r&&f(e,r),o}()],g={type:Phaser.AUTO,scale:{parent:"root",width:800,height:600,autoCenter:Phaser.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{debug:!0,gravity:{y:0}}},scene:x};t.default=new Phaser.Game(g)}]);